<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalendarz</title>

    <style>
        #calendar {
            width: 60%;
            margin: 20px auto;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .day-name {
            font-weight: bold;
            text-align: center;
            padding: 5px 0;
        }

        .day {
            height: 50px;
            background: #f3f3f3;
            border-radius: 4px;
            text-align: center;
            line-height: 50px;
            cursor: pointer;
            transition: 0.2s;
        }

        .day:hover {
            background: #dcdcdc;
        }

        .today {
            background: #33ccff;
            border: 2px solid #0099ff;
            color: #000;
            font-weight: bold;
        }
        .today:hover{
            background: #0099ff;
        }

        #dayModal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        #dayModalContent {
            background: white;
            padding: 20px;
            border-radius: 8px;
            min-width: 250px;
            position: relative;
        }

        #closeModal {
            cursor: pointer;
            position: absolute;
            top: 10px;
            right: 10px;
            font-weight: bold;
            font-size: 18px;
        }

    </style>
</head>
<body>

<div id="calendar">
    <div class="calendar-header">
        <button id="prevMonth">&lt;</button>
        <h2 id="monthLabel"></h2>
        <button id="nextMonth">&gt;</button>
        <button id="todayBtn">Dzisiaj</button>
    </div>

    <div class="calendar-grid" id="calendarGrid"></div>
</div>

<div id="dayModal">
    <div id="dayModalContent">
        <span id="closeModal">&times;</span>
        <h3>Wybrany dzień:</h3>
        <p id="selectedDate"></p>
    </div>
</div>


<script th:inline="javascript">
    document.addEventListener("DOMContentLoaded", function () {

        const calendarGrid = document.getElementById("calendarGrid");
        const monthLabel = document.getElementById("monthLabel");

        const modal = document.getElementById("dayModal");
        const closeModal = document.getElementById("closeModal");
        const selectedDate = document.getElementById("selectedDate");

        let currentDate = new Date();

        const dayNames = ["Pn", "Wt", "Śr", "Cz", "Pt", "So", "Nd"];
        const monthNames = [
            "Styczeń", "Luty", "Marzec", "Kwiecień",
            "Maj", "Czerwiec", "Lipiec", "Sierpień",
            "Wrzesień", "Październik", "Listopad", "Grudzień"
        ];

        function renderCalendar() {

            calendarGrid.innerHTML = "";

            dayNames.forEach(d => {
                let el = document.createElement("div");
                el.classList.add("day-name");
                el.textContent = d;
                calendarGrid.appendChild(el);
            });

            let year = currentDate.getFullYear();
            let month = currentDate.getMonth();

            monthLabel.textContent = monthNames[month] + " " + year;

            let firstDayOfMonth = new Date(year, month, 1);
            let daysInMonth = new Date(year, month + 1, 0).getDate();

            let startDay = (firstDayOfMonth.getDay() + 6) % 7;

            for (let i = 0; i < startDay; i++) {
                let empty = document.createElement("div");
                calendarGrid.appendChild(empty);
            }

            for (let day = 1; day <= daysInMonth; day++) {
                let cell = document.createElement("div");
                cell.classList.add("day");
                cell.textContent = day;

                let now = new Date();
                if (
                    day === now.getDate() &&
                    month === now.getMonth() &&
                    year === now.getFullYear()
                ) {
                    cell.classList.add("today");
                }

                cell.onclick = () => {
                    selectedDate.textContent = `${day}.${month+1}.${year}`;
                    modal.style.display = "flex";
                };

                calendarGrid.appendChild(cell);
            }
        }

        document.getElementById("prevMonth").onclick = () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        };

        document.getElementById("nextMonth").onclick = () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        };

        document.getElementById("todayBtn").onclick = () => {
            currentDate = new Date();
            renderCalendar();
        };


        closeModal.onclick = () => modal.style.display = "none";

        window.onclick = (e) => {
            if (e.target === modal) modal.style.display = "none";
        };

        renderCalendar();
    });
</script>

</body>
</html>
